/*! LineUpJS - v0.1.0 - 2015-10-19
* https://github.com/Caleydo/lineup.js
* Copyright (c) 2015 ; Licensed BSD */

//based on https://github.com/ForbesLindesay/umd but with d3 dependency
;(function (f) {
  // CommonJS
  if (typeof exports === "object" && typeof module !== "undefined") {
    module.exports = f(require)(1);

    // RequireJS
  } else if (typeof define === "function" && define.amd) {
    var deps = ['d3'];
    define(deps, function () {
      var resolved_deps = arguments;
      return f(function(name) { return resolved_deps[deps.indexOf(name)]; })(1);
    });
    // <script>
  } else {
    var g;
    if (typeof window !== "undefined") {
      g = window;
    } else if (typeof global !== "undefined") {
      g = global;
    } else if (typeof self !== "undefined") {
      g = self;
    } else {
      // works providing we're not in "use strict";
      // needed for Java 8 Nashorn
      // seee https://github.com/facebook/react/issues/3037
      g = this;
    }
    g.LineUpJS = f(function(name) { return g[name]; })(1);
  }

})(function (require) {
  return !function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){var b=n.scale.category10().range().slice();return a.forEach(function(a){switch(a.type){case"number":a.color=b.shift()}}),a}function e(a,b){return new i.LocalDataProvider(a,b)}function f(a,b,c){return void 0===c&&(c={}),new o(b,a,c)}var g=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},h=a("./model"),i=a("./provider"),j=a("./renderer"),k=a("./ui"),l=a("./utils"),m=a("./ui_dialogs"),n=a("d3");c.model=h,c.provider=i,c.renderer=j,c.ui=k,c.utils=l,c.ui_dialogs=m;var o=function(a){function b(b,d,e){var f=this;void 0===e&&(e={}),a.call(this),this.data=d,this.config={idPrefix:Math.random().toString(36).slice(-8).substr(0,3),numberformat:n.format(".3n"),htmlLayout:{headerHeight:20,headerOffset:1,buttonTopPadding:10,labelLeftPadding:5},renderingOptions:{stacked:!1,animation:!0,visibleRowsOnly:!0},svgLayout:{rowHeight:17,rowPadding:.2,rowBarPadding:1,visibleRowsOnly:!0,backupScrollRows:4,animationDuration:1e3,rowActions:[]},manipulative:!0,interaction:{tooltips:!0,multiselect:function(){return!1},rangeselect:function(){return!1}},pool:!1},this.body=null,this.header=null,this.pools=[],this.contentScroller=null,this.$container=b instanceof n.selection?b:n.select(b),this.$container=this.$container.append("div").classed("lu",!0),c.utils.merge(this.config,e),this.data.on("selectionChanged.main",this.triggerSelection.bind(this)),this.header=new k.HeaderRenderer(d,this.node,{manipulative:this.config.manipulative,headerHeight:this.config.htmlLayout.headerHeight}),this.body=new k.BodyRenderer(d,this.node,this.slice.bind(this),{rowHeight:this.config.svgLayout.rowHeight,rowPadding:this.config.svgLayout.rowPadding,rowBarPadding:this.config.svgLayout.rowBarPadding,animationDuration:this.config.svgLayout.animationDuration,animation:this.config.renderingOptions.animation,stacked:this.config.renderingOptions.stacked,actions:this.config.svgLayout.rowActions,idPrefix:this.config.idPrefix}),this.forward(this.body,"hoverChanged"),this.config.pool&&this.config.manipulative&&this.addPool(new k.PoolRenderer(d,this.node,this.config)),this.config.svgLayout.visibleRowsOnly&&(this.contentScroller=new l.ContentScroller(this.$container.node(),this.body.node,{backupRows:this.config.svgLayout.backupScrollRows,rowHeight:this.config.svgLayout.rowHeight,topShift:this.config.htmlLayout.headerHeight}),this.contentScroller.on("scroll",function(a,b){f.header.$node.style("transform","translate(0px,"+a+"px)")}),this.contentScroller.on("redraw",this.body.update.bind(this.body)))}return g(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["hoverChanged","selectionChanged","multiSelectionChanged"])},b.prototype.addPool=function(a,b){return void 0===b&&(b=this.config),a instanceof k.PoolRenderer?this.pools.push(a):this.pools.push(new k.PoolRenderer(this.data,a,b)),this.pools[this.pools.length-1]},Object.defineProperty(b.prototype,"node",{get:function(){return this.$container.node()},enumerable:!0,configurable:!0}),b.prototype.slice=function(a,b,c){return this.contentScroller?this.contentScroller.select(a,b,c):{from:a,to:b}},b.prototype.destroy=function(){this.pools.forEach(function(a){return a.remove()}),this.$container.remove(),this.contentScroller&&this.contentScroller.destroy()},b.prototype.sortBy=function(a,b){void 0===b&&(b=!1);var c=this.data.find(a);return c&&c.sortByMe(b),null!==c},b.prototype.dump=function(){var a=this.data.dump();return a},b.prototype.changeDataStorage=function(a,b){this.data&&this.data.on("selectionChanged.main",null),this.data=a,b&&this.data.restore(b),this.data.on("selectionChanged.main",this.triggerSelection.bind(this)),this.header.changeDataStorage(a),this.body.changeDataStorage(a),this.pools.forEach(function(b){return b.changeDataStorage(a)}),this.update()},b.prototype.triggerSelection=function(a){this.fire("selectionChanged",a.length>0?a[0]:-1),this.fire("multiSelectionChanged",a)},b.prototype.restore=function(a){this.changeDataStorage(this.data,a)},b.prototype.update=function(){this.header.update(),this.body.update(),this.pools.forEach(function(a){return a.update()})},b.prototype.changeRenderingOption=function(a,b){this.config.renderingOptions[a]=b,("animation"===a||"stacked"===a)&&(this.body.setOption(a,b),this.body.update())},b}(l.AEventDispatcher);c.LineUp=o,c.deriveColors=d,c.createLocalStorage=e,c.create=f},{"./model":3,"./provider":4,"./renderer":5,"./ui":6,"./ui_dialogs":7,"./utils":8,d3:void 0}],2:[function(a,b,c){function d(a,b,c,d,e,f){return a.append("line").attr({x1:b,y1:c,x2:d,y2:e,"class":f})}function e(a,b,c,d,e,f){return a.append("text").attr({x:b,y:c,dy:e,"class":f}).text(d)}function f(a,b,c,d,e){return c-=b,a.append("circle").attr({"class":"handle",r:e,cx:b,cy:d,transform:"translate("+c+",0)"})}function g(a,b,c,g){g=i.merge({width:320,height:250,padding_hor:10,padding_ver:30,radius:8,callback:function(a){return a},callbackThisArg:null,triggerCallback:"change"},g);var j=function(i){function j(a,b){return h.behavior.drag().on("dragstart",function(){h.select(this).classed("dragging",!0).attr("r",1.1*g.radius),a.style("visibility","visible")}).on("drag",b).on("dragend",function(){h.select(this).classed("dragging",!1).attr("r",g.radius),a.style("visibility",null),m(!0)}).origin(function(){var a=h.transform(h.select(this).attr("transform"));return{x:a.translate[0],y:a.translate[1]}})}function k(){a.range([v,w]),A.attr("x1",a),m()}function l(){var b,c;y>x?(b=A.filter(function(a){return t(a)<x||t(a)>y}),c=A.filter(function(a){return!(t(a)<x||t(a)>y)})):(b=A.filter(function(a){return t(a)>x||t(a)<y}),c=A.filter(function(a){return!(t(a)>x||t(a)<y)})),b.style("visibility","hidden"),a.domain([t.invert(x),t.invert(y)]),c.style("visibility",null).attr("x1",a),m()}function m(a){if(void 0===a&&(a=!1),a===("dragend"===g.triggerCallback)){var b=h.scale.linear().domain([t.invert(x),t.invert(y)]).range([u.invert(v),u.invert(w)]);g.callback.call(g.callbackThisArg,b)}}function n(b){return function(){function c(){var c=t.domain(),f=c.slice();f[b]=+this.value,c[b]!==f[b]&&(t.domain(f),d.text(this.value),x=t(a.domain()[0]),y=t(a.domain()[1]),H.attr("transform","translate("+(x-p)+",0)"),I.attr("transform","translate("+(y-q)+",0)"),B.attr("x2",x),C.attr("x2",y),A.attr("x2",t),l(),m(!0),e.remove())}var d=h.select(this),e=z.append("foreignObject").attr({x:0===b?p-7:q-45,y:s+15,width:50,height:20});e.append("xhtml:input").attr("value",t.domain()[b]).style("width","5em").on("change",c).on("blur",c)}}var o=i.append("svg").attr({"class":"lugui-me",width:g.width,height:g.height}),p=g.padding_hor,q=g.width-g.padding_hor,r=g.padding_ver,s=g.height-g.padding_ver,t=h.scale.linear().domain([Math.min(b[0],a.domain()[0]),Math.min(b[1],a.domain()[1])]).range([p,q]),u=h.scale.linear().domain([0,1]).range([p,q]),v=u(a.range()[0]),w=u(a.range()[1]),x=t(a.domain()[0]),y=t(a.domain()[1]);a=h.scale.linear().clamp(!0).domain(a.domain()).range([v,w]);var z=o.append("g");d(z,p,r,q,r,"axis"),e(z,p,r-25,0,".75em"),e(z,q,r-25,1,".75em"),e(z,g.width/2,r-25,"Score",".75em","centered"),d(z,p,s,q,s,"axis"),e(z,p,s+20,t.domain()[0],".75em").on("click",n(0)).classed("editableLabel",!0).append("title").text("Click to Modify"),e(z,q,s+20,t.domain()[1],".75em").on("click",n(1)).classed("editableLabel",!0).append("title").text("Click to Modify"),e(z,g.width/2,s+20,"Raw",".75em","centered");var A=o.append("g").classed("data",!0).selectAll("line").data([]);c.then(function(b){A=A.data(b),A.enter().append("line").attr({x1:a,y1:r,x2:t,y2:s}).style("visibility",function(a){var b;return b=y>x?t(a)<x||t(a)>y:t(a)>x||t(a)<y,b?"hidden":null})});var B=d(o,v,r,x,s,"bound"),C=d(o,w,r,y,s,"bound"),D=e(o,p+5,r-15,h.round(u.invert(v),2),".25em","drag").attr("transform","translate("+(v-p)+",0)"),E=e(o,p+5,s-15,h.round(t.invert(x),2),".25em","drag").attr("transform","translate("+(x-p)+",0)"),F=e(o,q+5,r-15,h.round(u.invert(w),2),".25em","drag").attr("transform","translate("+(w-q)+",0)"),G=e(o,q+5,s-15,h.round(t.invert(y),2),".25em","drag").attr("transform","translate("+(y-q)+",0)");f(o,p,v,r,g.radius).call(j(D,function(){h.event.x>=0&&h.event.x<=q-p&&(B.attr("x1",p+h.event.x),h.select(this).attr("transform","translate("+h.event.x+", 0)"),v=h.event.x+p,D.text(h.round(u.invert(v),2)).attr("transform","translate("+h.event.x+", 0)"),k())})),f(o,q,w,r,g.radius).call(j(F,function(){h.event.x>=-1*(q-p)&&h.event.x<=0&&(C.attr("x1",q+h.event.x),h.select(this).attr("transform","translate("+h.event.x+", 0)"),w=h.event.x+q,F.text(h.round(u.invert(w),2)).attr("transform","translate("+h.event.x+", 0)"),k())}));var H=f(o,p,x,s,g.radius).call(j(E,function(){h.event.x>=0&&h.event.x<=q-p&&(B.attr("x2",p+h.event.x),h.select(this).attr("transform","translate("+h.event.x+", 0)"),x=h.event.x+p,E.text(h.round(t.invert(x),2)).attr("transform","translate("+h.event.x+", 0)"),l())})),I=f(o,q,y,s,g.radius).call(j(G,function(){h.event.x>=-1*(q-p)&&h.event.x<=0&&(C.attr("x2",q+h.event.x),h.select(this).attr("transform","translate("+h.event.x+", 0)"),y=h.event.x+q,G.text(h.round(t.invert(y),2)).attr("transform","translate("+h.event.x+", 0)"),l())}))};return j}var h=a("d3"),i=a("./utils");c.open=g},{"./utils":8,d3:void 0}],3:[function(a,b,c){function d(a){return a.replace(/[\s!#$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|}~]/g,"_")}function e(a,b){return a===b||isNaN(a)&&isNaN(b)?0:a-b}function f(a){return a instanceof l&&"function"==typeof a.getNumber||!(a instanceof l)&&a.type.match(/(number|stack|ordinal)/)}function g(a){return void 0===a&&(a="actions"),{type:"actions",label:a}}function h(){return{number:o,string:p,link:q,stack:u,rank:v,categorical:s,ordinal:t,actions:n,annotate:r}}var i=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},j=a("d3"),k=a("./utils"),l=function(a){function b(c,e){a.call(this),this.desc=e,this.width_=100,this.parent=null,this.id=d(c),this.label=this.desc.label||this.id,this.color=this.desc.color||b.DEFAULT_COLOR}return i(b,a),b.prototype.assignNewId=function(a){this.id=d(a())},b.prototype.init=function(a){return Promise.resolve(!0)},Object.defineProperty(b.prototype,"fqid",{get:function(){return this.parent?this.parent.fqid+"_"+this.id:this.id},enumerable:!0,configurable:!0}),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["widthChanged","filterChanged","labelChanged","addColumn","removeColumn","dirty","dirtyHeader","dirtyValues"])},b.prototype.getWidth=function(){return this.width_},b.prototype.flatten=function(a,b,c,d){return void 0===c&&(c=0),void 0===d&&(d=0),a.push({col:this,offset:b,width:this.getWidth()}),this.getWidth()},b.prototype.setWidth=function(a){this.width_!==a&&this.fire(["widthChanged","dirtyHeader","dirtyValues","dirty"],this.width_,this.width_=a)},b.prototype.setWidthImpl=function(a){this.width_=a},b.prototype.setMetaData=function(a,b){if(void 0===b&&(b=this.color),a!==this.label||this.color!==b){var c=this.color===b?["labelChanged","dirtyHeader","dirty"]:["labelChanged","dirtyHeader","dirtyValues","dirty"];this.fire(c,{label:this.label,color:this.color},{label:this.label=a,color:this.color=b})}},b.prototype.sortByMe=function(a){void 0===a&&(a=!1);var b=this.findMyRanker();return b?b.sortBy(this,a):!1},b.prototype.toggleMySorting=function(){var a=this.findMyRanker();return a?a.toggleSorting(this):!1},b.prototype.removeMe=function(){return this.parent?this.parent.remove(this):!1},b.prototype.insertAfterMe=function(a){return this.parent?this.parent.insertAfter(a,this):!1},b.prototype.findMyRanker=function(){return this.parent?this.parent.findMyRanker():null},b.prototype.dump=function(a){var c={id:this.id,desc:a(this.desc),width:this.width_};return this.label!==(this.desc.label||this.id)&&(c.label=this.label),this.color!==(this.desc.color||b.DEFAULT_COLOR)&&(c.color=this.color),c},b.prototype.restore=function(a,b){this.width_=a.width||this.width_,this.label=a.label||this.label,this.color=a.color||this.color},b.prototype.getLabel=function(a){return""+this.getValue(a)},b.prototype.getValue=function(a){return""},b.prototype.compare=function(a,b){return 0},b.prototype.isFiltered=function(){return!1},b.prototype.filter=function(a){return null!==a},b.DEFAULT_COLOR="#C1C1C1",b.FLAT_ALL_COLUMNS=-1,b}(k.AEventDispatcher);c.Column=l;var m=function(a){function b(b,c){a.call(this,b,c),this.accessor=c.accessor||function(a,b,c){return null}}return i(b,a),b.prototype.getLabel=function(a){return""+this.getValue(a)},b.prototype.getValue=function(a){return this.accessor(a,this.id,this.desc)},b.prototype.compare=function(a,b){return 0},b}(l);c.ValueColumn=m;var n=function(a){function b(b,c){a.call(this,b,c)}return i(b,a),b.prototype.getLabel=function(a){return""},b.prototype.getValue=function(a){return""},b.prototype.compare=function(a,b){return 0},b}(l);c.DummyColumn=n,c.isNumberColumn=f;var o=function(a){function b(b,c){a.call(this,b,c),this.missingValue=0,this.scale=j.scale.linear().domain([NaN,NaN]).range([0,1]).clamp(!0),this.original=j.scale.linear().domain([NaN,NaN]).range([0,1]).clamp(!0),this.filter_={min:-(1/0),max:1/0},c.domain&&this.scale.domain(c.domain),c.range&&this.scale.range(c.range),this.original.domain(this.scale.domain()).range(this.scale.range())}return i(b,a),b.prototype.init=function(a){var b=this,c=this.scale.domain();return isNaN(c[0])||isNaN(c[1])?a(this.desc).then(function(a){return b.scale.domain([a.min,a.max]),b.original.domain(b.scale.domain()),!0}):Promise.resolve(!0)},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.domain=this.scale.domain(),c.range=this.scale.range(),c.mapping=this.getOriginalMapping(),c.filter=this.filter,c.missingValue=this.missingValue,c},b.prototype.restore=function(b,c){a.prototype.restore.call(this,b,c),b.domain&&this.scale.domain(b.domain),b.range&&this.scale.range(b.range),b.mapping&&this.original.domain(b.mapping.domain).range(b.mapping.range),b.filter&&(this.filter_=b.filter),b.missingValue&&(this.missingValue=b.missingValue)},b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["mappingChanged"])},b.prototype.getLabel=function(b){return""+a.prototype.getValue.call(this,b)},b.prototype.getRawValue=function(b){var c=a.prototype.getValue.call(this,b);return"undefined"==typeof c||null==c||isNaN(c)||""===c||"NA"===c||"string"==typeof c&&"na"===c.toLowerCase()?this.missingValue:+c},b.prototype.getValue=function(a){var b=this.getRawValue(a);return isNaN(b)?b:this.scale(b)},b.prototype.getNumber=function(a){return this.getValue(a)},b.prototype.compare=function(a,b){return e(this.getValue(a),this.getValue(b))},b.prototype.getMapping=function(){return{domain:this.scale.domain(),range:this.scale.range()}},b.prototype.getOriginalMapping=function(){return{domain:this.original.domain(),range:this.original.range()}},b.prototype.setMapping=function(a,b){var c=this.getMapping();this.scale.domain(a).range(b),this.fire(["mappingChanged","dirtyValues","dirty"],c,this.getMapping())},b.prototype.isFiltered=function(){return isFinite(this.filter_.min)||isFinite(this.filter_.max)},Object.defineProperty(b.prototype,"filterMin",{get:function(){return this.filter_.min},set:function(a){var b={min:this.filter_.min,max:this.filter_.max};this.filter_.min=isNaN(a)?-(1/0):a,this.fire(["filterChanged","dirtyValues","dirty"],b,this.filter_)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"filterMax",{get:function(){return this.filter_.max},set:function(a){var b={min:this.filter_.min,max:this.filter_.max};this.filter_.max=isNaN(a)?1/0:a,this.fire(["filterChanged","dirtyValues","dirty"],b,this.filter_)},enumerable:!0,configurable:!0}),b.prototype.getFilter=function(){return this.filter_},b.prototype.setFilter=function(a,b){void 0===a&&(a=-(1/0)),void 0===b&&(b=+(1/0));var c={min:this.filter_.min,max:this.filter_.max};this.filter_.min=isNaN(a)?-(1/0):a,this.filter_.max=isNaN(b)?1/0:b,this.fire(["filterChanged","dirtyValues","dirty"],c,this.filter_)},b.prototype.filter=function(a){if(!this.isFiltered())return!0;var b=this.getRawValue(a);return isNaN(b)?!0:!(isFinite(this.filter_.min)&&b<this.filter_.min||isFinite(this.filter_.max)&&b<this.filter_.max)},b}(m);c.NumberColumn=o;var p=function(a){function b(b,c){a.call(this,b,c),this.filter_=null,this.setWidthImpl(200)}return i(b,a),b.prototype.getValue=function(b){var c=a.prototype.getValue.call(this,b);return"undefined"==typeof c||null==c?"":c},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return this.filter_ instanceof RegExp?c.filter="REGEX:"+this.filter_.source:c.filter=this.filter_,c},b.prototype.restore=function(b,c){a.prototype.restore.call(this,b,c),b.filter&&"REGEX:"===b.filter.slice(0,6)?this.filter_=new RegExp(b.filter.slice(6)):this.filter_=b.filter||null},b.prototype.isFiltered=function(){return null!=this.filter_},b.prototype.filter=function(a){if(!this.isFiltered())return!0;var b=this.getLabel(a),c=this.filter_;return"string"==typeof c&&c.length>0?b&&b.toLowerCase().indexOf(c.toLowerCase())>=0:c instanceof RegExp?b&&c.test(b):!0},b.prototype.getFilter=function(){return this.filter_},b.prototype.setFilter=function(a){""===a&&(a=null),this.fire(["filterChanged","dirtyValues","dirty"],this.filter_,this.filter_=a)},b.prototype.compare=function(a,b){return j.ascending(this.getValue(a),this.getValue(b))},b}(m);c.StringColumn=p;var q=function(a){function b(b,c){a.call(this,b,c),this.link=null,this.link=c.link}return i(b,a),b.prototype.getLabel=function(b){var c=a.prototype.getValue.call(this,b);return c.alt?c.alt:""+c},b.prototype.getValue=function(b){var c=a.prototype.getValue.call(this,b);return c.href?c.href:this.link?this.link.replace(/\$1/g,c):c},b}(p);c.LinkColumn=q;var r=function(a){function b(b,c){a.call(this,b,c),this.annotations=j.map()}return i(b,a),b.prototype.getValue=function(b){var c=String(b._index);return this.annotations.has(c)?this.annotations.get(c):a.prototype.getValue.call(this,b)},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.annotations={},this.annotations.forEach(function(a,b){c.annotations[a]=b}),c},b.prototype.restore=function(b,c){var d=this;a.prototype.restore.call(this,b,c),b.annotations&&Object.keys(b.annotations).forEach(function(a){d.annotations.set(a,b.annotations[a])})},b.prototype.setValue=function(a,b){var c=this.getValue(a);return c===b?!0:(""===b||null==b?this.annotations.remove(String(a._index)):this.annotations.set(String(a._index),b),this.fire(["dirtyValues","dirty"],b,c),!0)},b}(p);c.AnnotateColumn=r;var s=function(a){function b(b,c){a.call(this,b,c),this.colors=j.scale.category10(),this.filter_=null,this.initCategories(c)}return i(b,a),b.prototype.initCategories=function(a){if(a.categories){var b=[],c=this.colors.range();a.categories.forEach(function(a,d){"string"==typeof a?b.push(a):(b.push(a.name),c[d]=a.color)}),this.colors.domain(b).range(c)}},Object.defineProperty(b.prototype,"categories",{get:function(){return this.colors.domain()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"categoryColors",{get:function(){return this.colors.range()},enumerable:!0,configurable:!0}),b.prototype.getValue=function(a){return p.prototype.getValue.call(this,a)},b.prototype.getColor=function(a){var b=this.getLabel(a);return null===b||""===b?null:this.colors(b)},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.filter=this.filter_,c.colors={domain:this.colors.domain(),range:this.colors.range()},c},b.prototype.restore=function(b,c){a.prototype.restore.call(this,b,c),this.filter_=b.filter||null,b.colors&&this.colors.domain(b.colors.domain).range(b.colors.range)},b.prototype.isFiltered=function(){return null!=this.filter_},b.prototype.filter=function(a){if(!this.isFiltered())return!0;var b=this.getLabel(a),c=this.filter_;return Array.isArray(c)&&c.length>0?c.indexOf(b)>=0:"string"==typeof c&&c.length>0?b&&b.toLowerCase().indexOf(c.toLowerCase())>=0:c instanceof RegExp?null!=b&&b.match(c).length>0:!0},b.prototype.getFilter=function(){return this.filter_},b.prototype.setFilter=function(a){this.fire(["filterChanged","dirtyValues","dirty"],this,this.filter_,this.filter_=a)},b.prototype.compare=function(a,b){return p.prototype.compare.call(this,a,b)},b}(m);c.CategoricalColumn=s;var t=function(a){function b(b,c){if(a.call(this,b,c),this.colors=j.scale.category10(),this.scale=j.scale.ordinal().rangeRoundPoints([0,1]),this.filter_=null,s.prototype.init.call(this,c),this.scale.domain(this.colors.domain()),c.categories){var d=[];c.categories.forEach(function(a){"string"!=typeof a&&"number"==typeof a.value?d.push(a.value):d.push(.5)}),this.scale.range(d)}}return i(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["mappingChanged"])},Object.defineProperty(b.prototype,"categories",{get:function(){return this.colors.domain()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"categoryColors",{get:function(){return this.colors.range()},enumerable:!0,configurable:!0}),b.prototype.getLabel=function(b){var c=a.prototype.getValue.call(this,b);return"undefined"==typeof c||null==c?"":c},b.prototype.getValue=function(a){var b=this.getLabel(a);return this.scale(b)},b.prototype.getNumber=function(a){return this.getValue(a)},b.prototype.getColor=function(a){return s.prototype.getColor.call(this,a)},b.prototype.dump=function(a){var b=s.prototype.dump.call(this,a);return b.scale={domain:this.scale.domain(),range:this.scale.range()},b},b.prototype.restore=function(a,b){s.prototype.restore.call(this,a,b),a.scale&&this.scale.domain(a.scale.domain).range(a.scale.range)},b.prototype.getScale=function(){return{domain:this.scale.domain(),range:this.scale.range()}},b.prototype.setRange=function(a){var b=this.getScale();this.scale.range(a),this.fire(["mappingChanged","dirtyValues","dirty"],b,this.getScale())},b.prototype.isFiltered=function(){return null!=this.filter_},b.prototype.filter=function(a){return s.prototype.filter.call(this,a)},b.prototype.getFilter=function(){return this.filter_},b.prototype.setFilter=function(a){this.fire(["filterChanged","dirtyValues","dirty"],this.filter_,this.filter_=a)},b.prototype.compare=function(a,b){return o.prototype.compare.call(this,a,b)},b}(m);c.CategoricalNumberColumn=t;var u=function(a){function b(b,c){a.call(this,b,c),this.missingValue=0,this.children_=[],this._collapsed=!1;var d=this;this.adaptChange=function(a,b){d.adaptWidthChange(this.source,a,b)}}return i(b,a),b.desc=function(a){return void 0===a&&(a="Combined"),{type:"stack",label:a}},b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["collapseChanged"])},b.prototype.assignNewId=function(b){a.prototype.assignNewId.call(this,b),this.children_.forEach(function(a){return a.assignNewId(b)})},Object.defineProperty(b.prototype,"children",{get:function(){return this.children_.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"length",{get:function(){return this.children_.length},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"weights",{get:function(){var a=this.getWidth();return this.children_.map(function(b){return b.getWidth()/a})},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"collapsed",{get:function(){return this._collapsed},set:function(a){this._collapsed!==a&&this.fire(["collapseChanged","dirtyHeader","dirty"],this._collapsed,this._collapsed=a)},enumerable:!0,configurable:!0}),b.prototype.flatten=function(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=0);var e=null;if(0===c||c<=l.FLAT_ALL_COLUMNS){var f=this.getWidth();if(this.collapsed||(f+=(this.children_.length-1)*d),a.push(e={col:this,offset:b,width:f}),0===c)return f}var g=b;return this.children_.forEach(function(b){g+=b.flatten(a,g,c-1,d)+d}),e&&(e.width=g-b-d),g-b-d},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.children=this.children_.map(function(a){return a.dump(b)}),c.missingValue=this.missingValue,c},b.prototype.restore=function(b,c){var d=this;b.missingValue&&(this.missingValue=b.missingValue),b.children.map(function(a){d.push(c(a))}),a.prototype.restore.call(this,b,c)},b.prototype.insert=function(b,c,d){return void 0===d&&(d=NaN),f(b)?(isNaN(d)||b.setWidth(d/(1-d)*this.getWidth()),this.children_.splice(c,0,b),b.parent=this,this.forward(b,"dirtyHeader.stack","dirtyValues.stack","dirty.stack","filterChanged.stack"),b.on("widthChanged.stack",this.adaptChange),a.prototype.setWidth.call(this,1===this.children_.length?b.getWidth():this.getWidth()+b.getWidth()),this.fire(["addColumn","dirtyHeader","dirtyValues","dirty"],b,b.getWidth()/this.getWidth()),!0):null},b.prototype.push=function(a,b){return void 0===b&&(b=NaN),this.insert(a,this.children_.length,b)},b.prototype.indexOf=function(a){var b=-1;return this.children_.some(function(c,d){return c===a?(b=d,!0):!1}),b},b.prototype.insertAfter=function(a,b,c){void 0===c&&(c=NaN);var d=this.indexOf(b);return 0>d?!1:this.insert(a,d+1,c)},b.prototype.adaptWidthChange=function(a,b,c){if(b!==c){var d=this.getWidth(),e=(c-b)/d,f=b/d,g=(1-f-e)/(1-f);this.children_.forEach(function(b){b===a||b.setWidthImpl(b.getWidth()*g)}),this.fire(["widthChanged","dirtyHeader","dirtyValues","dirty"],d,d)}},b.prototype.setWeights=function(a){var b,c=a.length-this.length;if(0>c)if(b=j.sum(a),1>=b)for(var d=0;-c>d;++d)a.push((1-b)*(1/-c));else if(100>=b)for(var d=0;-c>d;++d)a.push((100-b)*(1/-c));a=a.slice(0,this.length),b=j.sum(a)/this.getWidth(),a=a.map(function(a){return a/b}),this.children_.forEach(function(b,c){b.setWidthImpl(a[c])}),this.fire(["widthChanged","dirtyHeader","dirtyValues","dirty"],this.getWidth(),this.getWidth())},b.prototype.remove=function(b){var c=this.children_.indexOf(b);return 0>c?!1:(this.children_.splice(c,1),b.parent=null,this.unforward(b,"dirtyHeader.stack","dirtyValues.stack","dirty.stack","filterChanged.stack"),b.on("widthChanged.stack",null),a.prototype.setWidth.call(this,0===this.length?100:this.getWidth()-b.getWidth()),this.fire(["removeColumn","dirtyHeader","dirtyValues","dirty"],b),!0)},b.prototype.setWidth=function(b){var c=b/this.getWidth();this.children_.forEach(function(a){a.setWidthImpl(a.getWidth()*c)}),a.prototype.setWidth.call(this,b)},b.prototype.getValue=function(a){var b=this.getWidth(),c=this.children_.reduce(function(c,d){return c+d.getValue(a)*(d.getWidth()/b)},0);return"undefined"==typeof c||null==c||isNaN(c)?this.missingValue:c},b.prototype.getNumber=function(a){return this.getValue(a)},b.prototype.compare=function(a,b){return e(this.getValue(a),this.getValue(b))},b.prototype.isFiltered=function(){return this.children_.some(function(a){return a.isFiltered()})},b.prototype.filter=function(a){return this.children_.every(function(b){return b.filter(a)})},b}(l);c.StackColumn=u;var v=function(a){function b(b,c){var d=this;a.call(this,b,c),this.sortBy_=null,this.ascending=!1,this.columns_=[],this.comparator=function(a,b){if(null===d.sortBy_)return 0;var c=d.sortBy_.compare(a,b);return d.ascending?c:-c},this.dirtyOrder=function(){d.fire(["dirtyOrder","dirtyValues","dirty"],d.sortCriteria())},this.order=[],this.setWidthImpl(50)}return i(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["sortCriteriaChanged","dirtyOrder","orderChanged"])},b.prototype.assignNewId=function(b){a.prototype.assignNewId.call(this,b),this.columns_.forEach(function(a){return a.assignNewId(b)})},b.prototype.setOrder=function(a){this.fire(["orderChanged","dirtyValues","dirty"],this.order,this.order=a)},b.prototype.getOrder=function(){return this.order},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.columns=this.columns_.map(function(a){return a.dump(b)}),c.sortCriteria={asc:this.ascending},this.sortBy_&&(c.sortCriteria.sortBy=this.sortBy_.id),c},b.prototype.restore=function(b,c){var d=this;a.prototype.restore.call(this,b,c),b.columns.map(function(a){d.push(c(a))}),b.sortCriteria&&(this.ascending=b.sortCriteria.asc,b.sortCriteria.sortBy&&this.sortBy(this.columns_.filter(function(a){return a.id===b.sortCriteria.sortBy})[0],b.sortCriteria.asc))},b.prototype.flatten=function(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=0),a.push({col:this,offset:b,width:this.getWidth()});var e=b+this.getWidth()+d;return(c>0||c<=l.FLAT_ALL_COLUMNS)&&this.columns_.forEach(function(b){e+=b.flatten(a,e,c-1,d)+d}),e-b},b.prototype.sortCriteria=function(){return{col:this.sortBy_,asc:this.ascending}},b.prototype.sortByMe=function(a){void 0===a&&(a=!1)},b.prototype.toggleMySorting=function(){},b.prototype.findMyRanker=function(){return this},b.prototype.insertAfterMe=function(a){return null!==this.insert(a,0)},b.prototype.toggleSorting=function(a){return this.sortBy_===a?this.sortBy(a,!this.ascending):this.sortBy(a)},b.prototype.sortBy=function(a,b){if(void 0===b&&(b=!1),null!==a&&a.findMyRanker()!==this)return!1;if(this.sortBy_===a&&this.ascending===b)return!0;this.sortBy_&&this.sortBy_.on("dirtyValues.order",null);var c=this.sortCriteria();return this.sortBy_=a,this.sortBy_&&this.sortBy_.on("dirtyValues.order",this.dirtyOrder),this.ascending=b,this.fire(["sortCriteriaChanged","dirtyOrder","dirtyHeader","dirtyValues","dirty"],c,this.sortCriteria()),!0},Object.defineProperty(b.prototype,"children",{get:function(){return this.columns_.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"length",{get:function(){return this.columns_.length},enumerable:!0,configurable:!0}),b.prototype.insert=function(a,b){return void 0===b&&(b=this.columns_.length),this.columns_.splice(b,0,a),a.parent=this,this.forward(a,"dirtyValues.ranking","dirtyHeader.ranking","dirty.ranking"),a.on("filterChanged.order",this.dirtyOrder),this.fire(["addColumn","dirtyHeader","dirtyValues","dirty"],a,b),null===this.sortBy_&&this.sortBy(a),a},b.prototype.insertAfter=function(a,b){if(b===this)return null!=this.insert(a,0);var c=this.columns_.indexOf(b);return 0>c?!1:null!=this.insert(a,c+1)},b.prototype.push=function(a){return this.insert(a)},b.prototype.remove=function(a){var b=this.columns_.indexOf(a);return 0>b?!1:(this.unforward(a,"dirtyValues.ranking","dirtyHeader.ranking","dirty.ranking"),a.parent=null,this.columns_.splice(b,1),this.fire(["removeColumn","dirtyHeader","dirtyValues","dirty"],a),this.sortBy_===a&&this.sortBy(this.columns_.length>0?this.columns_[0]:null),!0)},Object.defineProperty(b.prototype,"flatColumns",{get:function(){var a=[];return this.flatten(a,0,l.FLAT_ALL_COLUMNS),a.map(function(a){return a.col})},enumerable:!0,configurable:!0}),b.prototype.find=function(a){for(var b="string"==typeof a?function(b){return b.id===a}:a,c=this.flatColumns,d=0;d<c.length;++d)if(b(c[d]))return c[d];return null},b.prototype.toSortingDesc=function(a){var b=function(c){if(null===c)return null;if(c instanceof u){var d=c.weights;return c.children.map(function(a,c){return{weight:d[c],id:b(a)}})}return a(c.desc)},c=b(this.sortBy_);return null===c?null:{id:c,asc:this.ascending}},b.prototype.isFiltered=function(){return this.columns_.some(function(a){return a.isFiltered()})},b.prototype.filter=function(a){return this.columns_.every(function(b){return b.filter(a)})},b}(m);c.RankColumn=v,c.createStackDesc=u.desc,c.createActionDesc=g,c.models=h},{"./utils":8,d3:void 0}],4:[function(a,b,c){function d(a,b,c){var d=h.layout.histogram().value(b);c&&d.range(function(){return c});var e=d(a);return{min:e[0].x,max:e[e.length-1].x+e[e.length-1].dx,count:a.length,hist:e
}}var e=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},f=a("./model"),g=a("./utils"),h=a("d3"),i=function(a){function b(){a.call(this),this.rankings_=[],this.selection=h.set(),this.uid=0,this.columnTypes=f.models();var b=this;this.reorder=function(){var a=this.source;b.sort(a).then(function(b){return a.setOrder(b)})}}return e(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["addColumn","removeColumn","addRanking","removeRanking","dirty","dirtyHeader","dirtyValues","selectionChanged"])},b.prototype.getColumns=function(){return[]},b.prototype.pushRanking=function(a){var b=this.cloneRanking(a);return this.pushRankingImpl(b),b},b.prototype.pushRankingImpl=function(a){this.rankings_.push(a),this.forward(a,"addColumn.provider","removeColumn.provider","dirty.provider","dirtyHeader.provider","dirtyValues.provider"),a.on("dirtyOrder.provider",this.reorder),this.fire(["addRanking","dirtyHeader","dirtyValues","dirty"],a)},b.prototype.removeRanking=function(a){var b=this.rankings_.indexOf(a);return 0>b?!1:(this.unforward(a,"addColumn.provider","removeColumn.provider","dirty.provider","dirtyHeader.provider","dirtyOrder.provider","dirtyValues.provider"),this.rankings_.splice(b,1),a.on("dirtyOrder.provider",null),this.cleanUpRanking(a),this.fire(["removeRanking","dirtyHeader","dirtyValues","dirty"],a),!0)},b.prototype.clearRankings=function(){var a=this;this.rankings_.forEach(function(b){a.unforward(b,"addColumn.provider","removeColumn.provider","dirty.provider","dirtyHeader.provider","dirtyOrder.provider","dirtyValues.provider"),b.on("dirtyOrder.provider",null),a.cleanUpRanking(b)}),this.rankings_=[],this.fire(["removeRanking","dirtyHeader","dirtyValues","dirty"])},b.prototype.getRankings=function(){return this.rankings_.slice()},b.prototype.getLastRanking=function(){return this.rankings_[this.rankings_.length-1]},b.prototype.cleanUpRanking=function(a){},b.prototype.cloneRanking=function(a){return null},b.prototype.push=function(a,b){var c=this.create(b);return c?(a.push(c),c):null},b.prototype.create=function(a){var b=this.columnTypes[a.type];return b?new b(this.nextId(),a):null},b.prototype.clone=function(a){var b=a.dump(function(a){return a});return this.restoreColumn(b)},b.prototype.restoreColumn=function(a){var b=this,c=function(a){var d=b.columnTypes[a.desc.type],e=new d("",a.desc);return e.restore(a,c),e.assignNewId(b.nextId.bind(b)),e};return c(a)},b.prototype.find=function(a){for(var b="string"==typeof a?function(b){return b.id===a}:a,c=0;c<this.rankings_.length;++c){var d=this.rankings_[c].find(b);if(d)return d}return null},b.prototype.insert=function(a,b,c){var d=this.create(c);return d?(a.insert(d,b),d):null},b.prototype.nextId=function(){return"col"+this.uid++},b.prototype.dump=function(){var a=this;return{uid:this.uid,selection:this.selection.values().map(Number),rankings:this.rankings_.map(function(b){return b.dump(a.toDescRef)})}},b.prototype.dumpColumn=function(a){return a.dump(this.toDescRef)},b.prototype.toDescRef=function(a){return a},b.prototype.fromDescRef=function(a){return a},b.prototype.restore=function(a){var b=this,c=function(a){var d=b.fromDescRef(a.desc),e=b.columnTypes[d.type],f=new e(a.id,d);return f.restore(a,c),f};this.clearRankings(),this.uid=a.uid||0,a.selection&&a.selection.forEach(function(a){return b.selection.add(String(a))}),a.rankings&&a.rankings.forEach(function(a){var d=b.pushRanking();d.restore(a,c)}),a.layout&&Object.keys(a.layout).forEach(function(c){b.deriveRanking(a.layout[c])});var d=this.nextId.bind(this);this.rankings_.forEach(function(a){a.children.forEach(function(a){return a.assignNewId(d)})})},b.prototype.findDesc=function(a){return null},b.prototype.deriveDefault=function(){var a=this;if(!(this.rankings_.length>0)){var b=this.pushRanking();this.getColumns().forEach(function(c){a.push(b,c)})}},b.prototype.deriveRanking=function(a){var b=this,c=function(a){if("rank"===a.type)return null;if("actions"===a.type){var d=b.create(f.createActionDesc(a.label||"actions"));return d.restore(a),d}if("stacked"===a.type){var d=b.create(f.StackColumn.desc(a.label||"Combined"));return(a.children||[]).forEach(function(a){var b=c(a);b&&d.push(b)}),d}var e=b.findDesc(a.column);if(e){var d=b.create(e);return a.label=a.label||e.label||e.column,d.restore(a),d}return null},d=this.pushRanking();return a.forEach(function(a){var b=c(a);b&&d.push(b)}),d},b.prototype.sort=function(a){return Promise.reject("not implemented")},b.prototype.view=function(a){return Promise.reject("not implemented")},b.prototype.mappingSample=function(a){return Promise.reject("not implemented")},b.prototype.stats=function(a,b){return Promise.reject("not implemented")},b.prototype.rowKey=function(a,b){return"number"==typeof a?String(a):String(a._index)},b.prototype.isSelected=function(a){return this.selection.has(String(a))},b.prototype.select=function(a){this.selection.add(String(a)),this.fire("selectionChanged",this.selection.values().map(Number))},b.prototype.searchSelect=function(a,b){},b.prototype.selectAll=function(a){var b=this;a.forEach(function(a){b.selection.add(String(a))}),this.fire("selectionChanged",this.selection.values().map(Number))},b.prototype.setSelection=function(a){this.selection=h.set(),this.selectAll(a)},b.prototype.toggleSelection=function(a,b){return void 0===b&&(b=!1),this.isSelected(a)?(b?this.deselect(a):this.clearSelection(),!1):(b?this.select(a):this.setSelection([a]),!0)},b.prototype.deselect=function(a){this.selection.remove(String(a)),this.fire("selectionChanged",this.selection.values().map(Number))},b.prototype.selectedRows=function(){return this.selection.empty()?Promise.resolve([]):this.view(this.getSelection())},b.prototype.getSelection=function(){var a=[];return this.selection.forEach(function(b){return a.push(+b)}),a.sort(),a},b.prototype.clearSelection=function(){this.selection=h.set(),this.fire("selectionChanged",[])},b}(g.AEventDispatcher);c.DataProvider=i;var j=function(a){function b(b){var c=this;void 0===b&&(b=[]),a.call(this),this.columns=b,this.rankingIndex=0,this.rowGetter=function(a,b,c){return a[c.column]},this.columns=b.slice(),b.forEach(function(a){a.accessor=c.rowGetter,a.label=a.label||a.column})}return e(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["addDesc"])},b.prototype.pushDesc=function(a){var b=a;b.accessor=this.rowGetter,b.label=a.label||b.column,this.columns.push(a),this.fire("addDesc",b)},b.prototype.getColumns=function(){return this.columns.slice()},b.prototype.findDesc=function(a){return this.columns.filter(function(b){return b.column===a})[0]},b.prototype.toDescRef=function(a){return a.column?a.type+"@"+a.column:a},b.prototype.fromDescRef=function(a){return"string"==typeof a?this.columns.filter(function(b){return b.type+"@"+b.column===a})[0]:a},b.prototype.restore=function(b){a.prototype.restore.call(this,b),this.rankingIndex=1+h.max(this.getRankings(),function(a){return+a.id.substring(4)})},b.prototype.nextRankingId=function(){return"rank"+this.rankingIndex++},b}(i);c.CommonDataProvider=j;var k=function(a){function b(b,c){void 0===c&&(c=[]),a.call(this,c),this.data=b,b.forEach(function(a,b){a._rankings={},a._index=b})}return e(b,a),b.prototype.cloneRanking=function(a){var b=this,c=this.nextRankingId(),d={label:"Rank",type:"rank",accessor:function(a,b){return a._rankings[b]+1||1}},e=new f.RankColumn(c,d);return a&&(this.data.forEach(function(b){var d=b._rankings;d[c]=d[a.id]}),a.children.forEach(function(a){b.push(e,a.desc)})),e},b.prototype.cleanUpRanking=function(a){this.data.forEach(function(b){return delete b._rankings[a.id]})},b.prototype.sort=function(a){var b=this.data.map(function(b,c){return{row:b,i:c,prev:b._rankings[a.id]||0}});a.isFiltered()&&(b=b.filter(function(b){return a.filter(b.row)})),b.sort(function(b,c){return a.comparator(b.row,c.row)});var c=b.map(function(b,c){return b.row._rankings[a.id]=c,b.i});return Promise.resolve(c)},b.prototype.view=function(a){var b=this,c=a.map(function(a){return b.data[a]});return Promise.resolve(c)},b.prototype.mappingSample=function(a){return Promise.resolve(this.data.map(a.getRawValue.bind(a)))},b.prototype.stats=function(a,b){return Promise.resolve(d(this.data,b.getNumber.bind(b),[0,1]))},b.prototype.searchSelect=function(a,b){var c="string"==typeof a?function(b){return b.indexOf(a)>=0}:function(b){return null!=b.match(a)},d=this.data.filter(function(a){return c(b.getLabel(a))}).map(function(a){return a._index});this.setSelection(d)},b}(j);c.LocalDataProvider=k;var l=function(a){function b(b,c){void 0===c&&(c=[]),a.call(this,c),this.server=b,this.ranks={}}return e(b,a),b.prototype.cloneRanking=function(a){var b=this,c=this.nextRankingId(),d={label:"Rank",type:"rank",accessor:function(a,c){return b.ranks[c][a._index]||0}};return a&&(this.ranks[c]=this.ranks[a.id]),new f.RankColumn(c,d)},b.prototype.cleanUpRanking=function(a){delete this.ranks[a.id]},b.prototype.sort=function(a){var b=this,c=a.toSortingDesc(function(a){return a.column});return this.server.sort(c).then(function(c){return b.ranks[a.id]=c,c})},b.prototype.view=function(a){return this.server.view(a).then(function(b){return b.forEach(function(b,c){return b._index=a[c]}),b})},b.prototype.mappingSample=function(a){return this.server.mappingSample(a.desc.column)},b.prototype.searchSelect=function(a,b){var c=this;this.server.search(a,b.desc.column).then(function(a){c.setSelection(a)})},b}(j);c.RemoteDataProvider=l},{"./model":3,"./utils":8,d3:void 0}],5:[function(a,b,c){function d(a){return a?new i(a):o}function e(a){return a?new l(a):p}function f(){return{string:d(),link:new q,number:e(),rank:d({textClass:"rank",align:"right"}),stack:new s,categorical:new r,ordinal:e({colorOf:function(a,b,c){return c.getColor(a)}}),max:e({colorOf:function(a,b,c){return c.getColor(a)}}),actions:new m,annotate:new n}}var g=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},h=function(){function a(){this.textClass="text",this.align="left"}return a.prototype.render=function(a,b,c,d){var e=this,f=a.datum(b).selectAll("text."+this.textClass).data(c,d.rowKey);f.enter().append("text").attr({"class":this.textClass,"clip-path":"url(#"+d.idPrefix+"clipCol"+b.id+")",y:function(a,b){return d.cellPrevY(b)}}),f.attr({x:function(a,c){return d.cellX(c)+("right"===e.align?b.getWidth()-5:0)},"data-index":function(a,b){return b}}).text(function(a){return b.getLabel(a)}),d.animated(f).attr({y:function(a,b){return d.cellY(b)}}),f.exit().remove()},a.prototype.findRow=function(a,b){return a.selectAll("text."+this.textClass+'[data-index="'+b+'"]')},a.prototype.mouseEnter=function(a,b,c,d,e,f){var g=b.node(),h=this.findRow(a,e).node();h&&g.appendChild(h)},a.prototype.mouseLeave=function(a,b,c,d,e,f){var g=a.node(),h=b.node();h.hasChildNodes()&&g.appendChild(h.firstChild),b.selectAll("*").remove()},a}();c.DefaultCellRenderer=h;var i=function(a){function b(b){var c=this;a.call(this),Object.keys(b).forEach(function(a){c[a]=b[a]})}return g(b,a),b}(h),j=function(a){function b(){a.apply(this,arguments)}return g(b,a),b.prototype.render=function(a,b,c,d){var e=this,f=a.datum(b).selectAll("rect.bar").data(c,d.rowKey);f.enter().append("rect").attr({"class":"bar",x:function(a,b){return d.cellX(b)},y:function(a,b){return d.cellPrevY(b)+d.option("rowPadding",1)},width:function(a){var c=b.getWidth()*b.getValue(a);return isNaN(c)?0:c}}).style("fill",b.color),f.attr({"data-index":function(a,b){return b},height:function(a,b){return d.rowHeight(b)-2*d.option("rowPadding",1)}}),d.animated(f).attr({x:function(a,b){return d.cellX(b)},y:function(a,b){return d.cellY(b)+d.option("rowPadding",1)},width:function(a){var c=b.getWidth()*b.getValue(a);return isNaN(c)?0:c}}).style({fill:function(a,c){return e.colorOf(a,c,b)}}),f.exit().remove()},b.prototype.colorOf=function(a,b,c){return c.color},b.prototype.findRow=function(a,b){return a.selectAll('rect.bar[data-index="'+b+'"]')},b.prototype.mouseEnter=function(a,b,c,d,e,f){var g=this.findRow(a,e);g.empty()||(b.node().appendChild(g.node()),b.append("text").datum(g.datum()).attr({"class":"number","clip-path":"url(#"+f.idPrefix+"clipCol"+c.id+")",transform:"translate("+f.cellX(e)+","+f.cellY(e)+")"}).text(function(a){return c.getLabel(a)}))},b}(h);c.BarCellRenderer=j;var k=function(a){function b(){a.apply(this,arguments)}return g(b,a),b.prototype.render=function(a,b,c,d){var e=this,f=a.datum(b).selectAll("rect.heatmap").data(c,d.rowKey);f.enter().append("rect").attr({"class":"bar",x:function(a,b){return d.cellX(b)},y:function(a,b){return d.cellPrevY(b)+d.option("rowPadding",1)},width:function(a,b){return d.rowHeight(b)-2*d.option("rowPadding",1)}}).style("fill",b.color),f.attr({"data-index":function(a,b){return b},width:function(a,b){return d.rowHeight(b)-2*d.option("rowPadding",1)},height:function(a,b){return d.rowHeight(b)-2*d.option("rowPadding",1)}}),d.animated(f).attr({x:function(a,b){return d.cellX(b)},y:function(a,b){return d.cellY(b)+d.option("rowPadding",1)}}).style({fill:function(a,c){return e.colorOf(a,c,b)}}),f.exit().remove()},b.prototype.colorOf=function(a,b,c){var d=c.getValue(a);isNaN(d)&&(d=0);var e=d3.hsl(c.color);return e.h=d,e.toString()},b.prototype.findRow=function(a,b){return a.selectAll('rect.heatmap[data-index="'+b+'"]')},b.prototype.mouseEnter=function(a,b,c,d,e,f){var g=this.findRow(a,e);g.empty()||(b.node().appendChild(g.node()),b.append("text").datum(g.datum()).attr({"class":"number","clip-path":"url(#"+f.idPrefix+"clipCol"+c.id+")",transform:"translate("+f.cellX(e)+","+f.cellY(e)+")"}).text(function(a){return c.getLabel(a)}))},b}(h);c.HeatMapCellRenderer=k;var l=function(a){function b(b){var c=this;a.call(this),Object.keys(b).forEach(function(a){c[a]=b[a]})}return g(b,a),b}(j),m=function(){function a(){}return a.prototype.render=function(a,b,c,d){},a.prototype.mouseEnter=function(a,b,c,d,e,f){var g=f.option("actions",[]),h=b.append("text").attr({"class":"actions fa",x:f.cellX(e),y:f.cellPrevY(e),"data-index":e}).selectAll("tspan").data(g);h.enter().append("tspan").text(function(a){return a.icon}).attr("title",function(a){return a.name}).on("click",function(a){d3.event.preventDefault(),d3.event.stopPropagation(),a.action(d)})},a.prototype.mouseLeave=function(a,b,c,d,e,f){b.selectAll("*").remove()},a}();c.ActionCellRenderer=m;var n=function(a){function b(){a.apply(this,arguments)}return g(b,a),b.prototype.mouseEnter=function(a,b,c,d,e,f){this.findRow(a,e).attr("display","none"),b.append("foreignObject").attr({x:f.cellX(e)-2,y:f.cellPrevY(e)-2,"data-index":e,width:c.getWidth(),height:f.rowHeight(e)}).append("xhtml:input").attr({type:"text",value:c.getValue(d)}).style({width:c.getWidth()+"px"}).on("change",function(){var a=this.value;c.setValue(d,a)}).on("click",function(){return d3.event.stopPropagation()})},b.prototype.mouseLeave=function(a,b,c,d,e,f){this.findRow(a,e).attr("display",null);var g=b.select("input").node();g&&c.setValue(d,g.value),b.selectAll("*").remove()},b}(h),o=new h,p=new j;c.defaultRenderer=d,c.barRenderer=e;var q=function(a){function b(){a.apply(this,arguments)}return g(b,a),b.prototype.render=function(a,b,c,d){var e=a.datum(b).selectAll("a.link").data(c,d.rowKey);e.enter().append("a").attr({"class":"link",target:"_blank"}).append("text").attr({"class":"text","clip-path":"url(#"+d.idPrefix+"clipCol"+b.id+")",y:function(a,b){return d.cellPrevY(b)}}),e.attr({x:function(a,b){return d.cellX(b)},"xlink:href":function(a){return b.getValue(a)},"data-index":function(a,b){return b}}).select("text").text(function(a){return b.getLabel(a)}),d.animated(e).select("text").attr({y:function(a,b){return d.cellY(b)}}),e.exit().remove()},b.prototype.findRow=function(a,b){return a.selectAll('a.link[data-index="'+b+'"]')},b}(h),r=function(a){function b(){a.apply(this,arguments),this.textClass="cat"}return g(b,a),b.prototype.render=function(a,b,c,d){var e=a.datum(b).selectAll("g."+this.textClass).data(c,d.rowKey),f=e.enter().append("g").attr({"class":this.textClass,"data-index":function(a,b){return b},transform:function(a,b){return"translate("+d.cellX(b)+","+d.cellPrevY(b)+")"}});f.append("text").attr({"clip-path":"url(#"+d.idPrefix+"clipCol"+b.id+")",x:function(a,b){return d.rowHeight(b)}}),f.append("rect").attr({y:d.option("rowPadding",1)}),e.attr({"data-index":function(a,b){return b},transform:function(a,b){return"translate("+d.cellX(b)+","+d.cellY(b)+")"}}),e.select("text").attr({x:function(a,b){return d.rowHeight(b)}}).text(function(a){return b.getLabel(a)}),e.select("rect").style({fill:function(a){return b.getColor(a)}}).attr({height:function(a,b){return Math.max(d.rowHeight(b)-2*d.option("rowPadding",1),0)},width:function(a,b){return Math.max(d.rowHeight(b)-2*d.option("rowPadding",1),0)}}),d.animated(e).attr({transform:function(a,b){return"translate("+d.cellX(b)+","+d.cellY(b)+")"}}),e.exit().remove()},b.prototype.findRow=function(a,b){return a.selectAll("g."+this.textClass+'[data-index="'+b+'"]')},b}(h),s=function(a){function b(){a.apply(this,arguments)}return g(b,a),b.prototype.renderImpl=function(a,b,c,d,e,f){void 0===f&&(f=!0);var g=a.datum(b),h=b.children,i=0,j=h.map(function(a){var b=i;return i+=a.getWidth(),b}),k="component"+c.option("stackLevel",""),l=c.cellX,m=c.option;c.option=function(a,b){var c=m(a,b);return"stackLevel"===a?c+"N":c};var n=g.selectAll("g."+k).data(h,function(a){return a.id});n.enter().append("g").attr({"class":k,transform:function(a,b){return"translate("+j[b]+",0)"}}),n.attr({"class":function(a){return k+" "+a.desc.type},"data-stack":function(a,b){return b}}).each(function(a,f){if(c.showStacked(b)){var g=h.slice(0,f);c.cellX=function(a){return l(a)-g.reduce(function(b,c){return b+c.getWidth()*(1-c.getValue(e(a)))},0)}}d(d3.select(this),a,f,c)}),(f?c.animated(n):n).attr({transform:function(a,b){return"translate("+j[b]+",0)"}}),n.exit().remove(),c.cellX=l,c.option=m},b.prototype.render=function(a,b,c,d){this.renderImpl(a,b,d,function(a,b,d,e){e.renderer(b).render(a,b,c,e)},function(a){return c[a]})},b.prototype.mouseEnter=function(a,b,c,d,e,f){var g="component"+f.option("stackLevel","");this.renderImpl(b,c,f,function(b,c,f,h){var i=a.select("g."+g+'[data-stack="'+f+'"]');i.empty()||h.renderer(c).mouseEnter(i,b,c,d,e,h)},function(a){return d},!1)},b.prototype.mouseLeave=function(a,b,c,d,e,f){var g="component"+f.option("stackLevel","");this.renderImpl(b,c,f,function(b,c,f,h){var i=a.select("g."+g+'[data-stack="'+f+'"]');i.empty()||h.renderer(c).mouseLeave(i,b,c,d,e,h)},function(a){return d},!1),b.selectAll("*").remove()},b}(h);c.renderers=f},{}],6:[function(a,b,c){var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},e=a("d3"),f=a("./utils"),g=a("./model"),h=a("./renderer"),i=a("./ui_dialogs"),j=function(){function a(a){this.desc=a,this.used=0}return a}(),k=function(){function a(a,b,c){void 0===c&&(c={}),this.data=a,this.options={layout:"vertical",elemWidth:100,elemHeight:40,width:100,height:500,additionalDesc:[],hideUsed:!0,addAtEndOnClick:!1},f.merge(this.options,c),this.$node=e.select(b).append("div").classed("lu-pool",!0),this.changeDataStorage(a)}return a.prototype.changeDataStorage=function(a){var b=this;if(this.data&&this.data.on(["addColumn.pool","removeColumn.pool","addRanking.pool","removeRanking.pool","addDesc.pool"],null),this.data=a,this.entries=a.getColumns().concat(this.options.additionalDesc).map(function(a){return new j(a)}),a.on(["addDesc.pool"],function(a){b.entries.push(new j(a)),b.update()}),this.options.hideUsed){var c=this;a.on(["addColumn.pool","removeColumn.pool"],function(a){var b=a.desc,d="addColumn"===this.type?1:-1;c.entries.some(function(a){return a.desc!==b?!1:(a.used+=d,!0)}),c.update()}),a.on(["addRanking.pool","removeRanking.pool"],function(a){var b=a.flatColumns.map(function(a){return a.desc}),d="addRanking"===this.type?1:-1;c.entries.some(function(a){return b.indexOf(a.desc)<0?!1:(a.used+=d,!0)}),c.update()}),a.getRankings().forEach(function(a){var b=a.flatColumns.map(function(a){return a.desc}),d=1;c.entries.some(function(a){return b.indexOf(a.desc)<0?!1:void(a.used+=d)})})}},a.prototype.remove=function(){this.$node.remove(),this.data&&this.data.on(["addColumn.pool","removeColumn.pool","addRanking.pool","removeRanking.pool","addDesc.pool"],null)},a.prototype.update=function(){var a=this,b=this.data,c=this.entries.filter(function(a){return 0===a.used}).map(function(a){return a.desc}),d=this.$node.selectAll("div.header").data(c),f=d.enter().append("div").attr({"class":"header",draggable:!0}).on("dragstart",function(a){var c=e.event;c.dataTransfer.effectAllowed="copyMove",c.dataTransfer.setData("text/plain",a.label),c.dataTransfer.setData("application/caleydo-lineup-column",JSON.stringify(b.toDescRef(a))),g.isNumberColumn(a)&&c.dataTransfer.setData("application/caleydo-lineup-column-number",JSON.stringify(b.toDescRef(a)))}).style({width:this.options.elemWidth+"px",height:this.options.elemHeight+"px"});switch(this.options.addAtEndOnClick&&f.on("click",function(b){a.data.push(a.data.getLastRanking(),b)}),f.append("span").classed("label",!0).text(function(a){return a.label}),d.style({transform:function(b,c){var d=a.layout(c);return"translate("+d.x+"px,"+d.y+"px)"},"background-color":function(a){return a.color||g.Column.DEFAULT_COLOR}}),d.attr({title:function(a){return a.label}}),d.select("span").text(function(a){return a.label}),d.exit().remove(),this.options.layout){case"horizontal":this.$node.style({width:this.options.elemWidth*c.length+"px",height:1*this.options.elemHeight+"px"});break;case"grid":var h=e.round(this.options.width/this.options.elemWidth,0);this.$node.style({width:h*this.options.elemWidth+"px",height:Math.ceil(c.length/h)*this.options.elemHeight+"px"});break;default:this.$node.style({width:1*this.options.elemWidth+"px",height:this.options.elemHeight*c.length+"px"})}},a.prototype.layout=function(a){switch(this.options.layout){case"horizontal":return{x:a*this.options.elemWidth,y:0};case"grid":var b=e.round(this.options.width/this.options.elemWidth,0);return{x:a%b*this.options.elemWidth,y:Math.floor(a/b)*this.options.elemHeight};default:return{x:0,y:a*this.options.elemHeight}}},a}();c.PoolRenderer=k;var l=function(){function a(a,b,c){var d=this;void 0===c&&(c={}),this.data=a,this.options={slopeWidth:150,columnPadding:5,headerHeight:20,manipulative:!0,filterDialogs:i.filterDialogs(),searchAble:function(a){return a instanceof g.StringColumn},sortOnLabel:!0},this.dragHandler=e.behavior.drag().on("dragstart",function(){e.select(this).classed("dragging",!0),e.event.sourceEvent.stopPropagation(),e.event.sourceEvent.preventDefault()}).on("drag",function(a){var b=Math.max(e.mouse(this.parentNode)[0],2);a.setWidth(b),e.event.sourceEvent.stopPropagation(),e.event.sourceEvent.preventDefault()}).on("dragend",function(){e.select(this).classed("dragging",!1),e.event.sourceEvent.stopPropagation(),e.event.sourceEvent.preventDefault()}),this.dropHandler=f.dropAble(["application/caleydo-lineup-column-ref","application/caleydo-lineup-column"],function(a,b,c){var e=null;if("application/caleydo-lineup-column-ref"in a){var f=a["application/caleydo-lineup-column-ref"];e=d.data.find(f),c?e=d.data.clone(e):e.removeMe()}else{var h=JSON.parse(a["application/caleydo-lineup-column"]);e=d.data.create(d.data.fromDescRef(h))}if(b instanceof g.Column)return b.insertAfterMe(e);var i=d.data.getLastRanking();return null!==i.push(e)}),f.merge(this.options,c),this.$node=e.select(b).append("div").classed("lu-header",!0),this.$node.append("div").classed("drop",!0).call(this.dropHandler),this.changeDataStorage(a)}return a.prototype.changeDataStorage=function(a){this.data&&this.data.on("dirtyHeader.headerRenderer",null),this.data=a,a.on("dirtyHeader.headerRenderer",f.delayedCall(this.update.bind(this),1))},a.prototype.update=function(){function a(b){return b instanceof g.StackColumn&&!b.collapsed?1+Math.max.apply(Math,b.children.map(a)):1}var b=this,c=this.data.getRankings(),d=[],e=0;c.forEach(function(a){e+=a.flatten(d,e,1,b.options.columnPadding)+b.options.slopeWidth}),e-=this.options.slopeWidth;var f=d.map(function(a){return a.col}),h=Math.max.apply(Math,f.map(a));this.$node.style("height",this.options.headerHeight*h+"px"),this.renderColumns(f,d)},a.prototype.createToolbar=function(a){var b=this,c=this.options.filterDialogs,d=this.data,f=a.filter(function(a){return!(a instanceof g.RankColumn)}),h=a.filter(function(a){return a instanceof g.StackColumn});h.append("i").attr("class","fa fa-tasks").attr("title","Edit Weights").on("click",function(a){i.openEditWeightsDialog(a,e.select(this.parentNode.parentNode)),e.event.stopPropagation()}),f.append("i").attr("class","fa fa-pencil-square-o").attr("title","Rename").on("click",function(a){i.openRenameDialog(a,e.select(this.parentNode.parentNode)),e.event.stopPropagation()}),f.append("i").attr("class","fa fa-code-fork").attr("title","Generate Snapshot").on("click",function(a){var b=d.pushRanking();b.push(d.clone(a)),e.event.stopPropagation()}),a.filter(function(a){return c.hasOwnProperty(a.desc.type)}).append("i").attr("class","fa fa-filter").attr("title","Filter").on("click",function(a){c[a.desc.type](a,e.select(this.parentNode.parentNode),d),e.event.stopPropagation()}),a.filter(function(a){return b.options.searchAble(a)}).append("i").attr("class","fa fa-search").attr("title","Search").on("click",function(a){i.openSearchDialog(a,e.select(this.parentNode.parentNode),d),e.event.stopPropagation()}),h.append("i").attr("class","fa").classed("fa-compress",function(a){return!a.collapsed}).classed("fa-expand",function(a){return a.collapsed}).attr("title","Compress/Expand").on("click",function(a){a.collapsed=!a.collapsed,e.select(this).classed("fa-compress",!a.collapsed).classed("fa-expand",a.collapsed),e.event.stopPropagation()}),a.append("i").attr("class","fa fa-times").attr("title","Hide").on("click",function(a){a instanceof g.RankColumn?(d.removeRanking(a),0===d.getRankings().length&&d.pushRanking()):a.removeMe(),e.event.stopPropagation()})},a.prototype.renderColumns=function(a,b,c,d){var h=this;void 0===c&&(c=this.$node),void 0===d&&(d="header");var i=c.selectAll("div."+d).data(a,function(a){return a.id}),j=i.enter().append("div").attr({"class":d}),k=j.append("div").classed("lu-label",!0).on("click",function(a){h.options.manipulative&&!e.event.defaultPrevented&&a.toggleMySorting()}).on("dragstart",function(a){var b=e.event;b.dataTransfer.effectAllowed="copyMove",b.dataTransfer.setData("text/plain",a.label),b.dataTransfer.setData("application/caleydo-lineup-column-ref",a.id);var c=JSON.stringify(h.data.toDescRef(a.desc));b.dataTransfer.setData("application/caleydo-lineup-column",c),g.isNumberColumn(a)&&(b.dataTransfer.setData("application/caleydo-lineup-column-number",c),b.dataTransfer.setData("application/caleydo-lineup-column-number-ref",a.id))});k.append("i").attr("class","fa fa sort_indicator"),k.append("span").classed("lu-label",!0).attr({draggable:this.options.manipulative}),this.options.manipulative&&(j.append("div").classed("handle",!0).call(this.dragHandler).style("width",this.options.columnPadding+"px").call(this.dropHandler),j.append("div").classed("toolbar",!0).call(this.createToolbar.bind(this))),i.style({width:function(a,c){return b[c].width+h.options.columnPadding+"px"},left:function(a,c){return b[c].offset+"px"},"background-color":function(a){return a.color}}),i.attr({title:function(a){return a.label}}),i.select("i.sort_indicator").attr("class",function(a){var b=a.findMyRanker();return b&&b.sortCriteria().col===a?"sort_indicator fa fa-sort-"+(b.sortCriteria().asc?"asc":"desc"):"sort_indicator fa"}),i.select("span.lu-label").text(function(a){return a.label});var l=this;i.filter(function(a){return a instanceof g.StackColumn}).each(function(a){if(a.collapsed)e.select(this).selectAll("div."+d+"_i").remove();else{var b=[];a.flatten(b,0,1,l.options.columnPadding);var c=b.map(function(a){return a.col});l.renderColumns(c,b,e.select(this),d+("_i"!==d.substr(d.length-2)?"_i":""))}}).call(f.dropAble(["application/caleydo-lineup-column-number-ref","application/caleydo-lineup-column-number"],function(a,b,c){var d=null;if("application/caleydo-lineup-column-number-ref"in a){var e=a["application/caleydo-lineup-column-number-ref"];d=h.data.find(e),c?d=h.data.clone(d):d.removeMe()}else{var f=JSON.parse(a["application/caleydo-lineup-column-number"]);d=h.data.create(h.data.fromDescRef(f))}return b.push(d)})),i.exit().remove()},a}();c.HeaderRenderer=l;var m=function(a){function b(b,c,d,g){void 0===g&&(g={}),a.call(this),this.data=b,this.slicer=d,this.options={rowHeight:20,rowPadding:1,rowBarPadding:1,idPrefix:"",slopeWidth:150,columnPadding:5,stacked:!0,animation:!1,animationDuration:1e3,renderers:h.renderers(),actions:[]},f.merge(this.options,g),this.$node=e.select(c).append("svg").classed("lu-body",!0),this.changeDataStorage(b)}return d(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["hoverChanged"])},Object.defineProperty(b.prototype,"node",{get:function(){return this.$node.node()},enumerable:!0,configurable:!0}),b.prototype.setOption=function(a,b){this.options[a]=b},b.prototype.changeDataStorage=function(a){this.data&&this.data.on(["dirtyValues.bodyRenderer","selectionChanged.bodyRenderer"],null),this.data=a,a.on("dirtyValues.bodyRenderer",f.delayedCall(this.update.bind(this),1)),a.on("selectionChanged.bodyRenderer",f.delayedCall(this.drawSelection.bind(this),1))},b.prototype.createContext=function(a){var b=this.options;return{rowKey:this.data.rowKey,cellY:function(c){return(c+a)*b.rowHeight},cellPrevY:function(c){return(c+a)*b.rowHeight},cellX:function(a){return 0},rowHeight:function(a){return b.rowHeight*(1-b.rowPadding)},renderer:function(a){if(a instanceof g.StackColumn&&a.collapsed)return b.renderers.number;var c=b.renderers[a.desc.type];return c||h.defaultRenderer()},showStacked:function(a){return b.stacked},idPrefix:b.idPrefix,animated:function(a){return b.animation?a.transition().duration(b.animationDuration):a},option:function(a,c){return a in b?b[a]:c}}},b.prototype.updateClipPathsImpl=function(a,b,c){var d=this.$node.select("defs.body");d.empty()&&(d=this.$node.append("defs").classed("body",!0));var e=d.selectAll(function(){return this.getElementsByTagName("clipPath")}).data(a,function(a){return a.id});e.enter().append("clipPath").attr("id",function(a){return b.idPrefix+"clipCol"+a.id}).append("rect").attr({y:0}),e.exit().remove(),e.select("rect").attr({x:0,width:function(a){return Math.max(a.getWidth()-5,0)},height:c})},b.prototype.updateClipPaths=function(a,b,c){var d=this,e=[],f=0;a.forEach(function(a){var b=a.flatten(e,f,2,d.options.columnPadding);f+=b+d.options.slopeWidth}),this.updateClipPathsImpl(e.map(function(a){return a.col}),b,c)},b.prototype.renderRankings=function(a,b,c,d,f){function g(a,b,c,g,h){a.classed("hover",!0);var i=a.select("g.values").selectAll("g.child").data([g].concat(g.children),function(a){return a.id});i.enter().append("g").attr({"class":"child"}),i.attr({transform:function(a,b){return"translate("+d[h].shifts[b]+",0)"}}).each(function(a,d){var g=this;j[h].then(function(h){f.renderer(a).mouseEnter(b.selectAll('g.child[data-index="'+d+'"]'),e.select(g),a,h[c],c,f)})}),i.exit().remove()}function h(a,b,c,d,g){a.classed("hover",!1),a.select("g.values").selectAll("g.child").each(function(a,d){var h=this;j[g].then(function(g){f.renderer(a).mouseLeave(b.selectAll('g.child[data-index="'+d+'"]'),e.select(h),a,g[c],c,f)})}).remove()}var i=this,j=c.map(function(a){return i.data.view(a)}),k=a.selectAll("g.ranking").data(b,function(a){return a.id}),l=k.enter().append("g").attr({"class":"ranking",transform:function(a,b){return"translate("+d[b].shift+",0)"}});l.append("g").attr("class","rows"),l.append("g").attr("class","cols"),f.animated(k).attr({
transform:function(a,b){return"translate("+d[b].shift+",0)"}});var m=k.select("g.cols").selectAll("g.child").data(function(a){return[a].concat(a.children)},function(a){return a.id});m.enter().append("g").attr({"class":"child",transform:function(a,b,c){return"translate("+d[c].shifts[b]+",0)"}}),m.attr({"data-index":function(a,b){return b}}),f.animated(m).attr({transform:function(a,b,c){return"translate("+d[c].shifts[b]+",0)"}}).each(function(a,b,c){var d=this;j[c].then(function(b){f.renderer(a).render(e.select(d),a,b,f)})}),m.exit().remove(),this.mouseOverItem=function(a,b){void 0===b&&(b=!0),k.each(function(c,d){var f=e.select(this),i=f.selectAll('g.row[data-index="'+a+'"]'),j=f.select("g.cols");if(!i.empty()){var k=i.datum().i;b?g(i,j,k,c,d):h(i,j,k,c,d)}})};var n=k.select("g.rows").selectAll("g.row").data(function(a,b){return c[b].map(function(a,b){return{d:a,i:b}})}),o=n.enter().append("g").attr({"class":"row"});o.append("rect").attr({"class":"bg"}),o.append("g").attr({"class":"values"}),o.on("mouseenter",function(a){i.mouseOver(a.d,!0)}).on("mouseleave",function(a){i.mouseOver(a.d,!1)}).on("click",function(a){i.select(a.d,e.event.ctrlKey)}),n.attr({"data-index":function(a){return a.d}}).classed("selected",function(a){return i.data.isSelected(a.d)}),n.select("rect").attr({y:function(a){return f.cellY(a.i)},height:function(a){return f.rowHeight(a.i)},width:function(a,b,c){return d[c].width},"class":function(a,b){return"bg "+(b%2===0?"even":"odd")}}),n.exit().remove(),k.exit().remove()},b.prototype.select=function(a,b){void 0===b&&(b=!1);var c=this.data.toggleSelection(a,b);this.$node.selectAll('g.row[data-index="'+a+'"], line.slope[data-index="'+a+'"]').classed("selected",c)},b.prototype.drawSelection=function(){var a=this.data.getSelection();if(0===a.length)this.$node.selectAll("g.row.selected, line.slope.selected").classed("selected",!1);else{var b=e.set(a);this.$node.selectAll("g.row").classed("selected",function(a){return b.has(String(a.d))}),this.$node.selectAll("line.slope").classed("selected",function(a){return b.has(String(a.data_index))})}},b.prototype.mouseOver=function(a,b){void 0===b&&(b=!0),this.fire("hoverChanged",b?a:-1),this.mouseOverItem(a,b),this.$node.selectAll('line.slope[data-index="'+a+'"]').classed("hover",b)},b.prototype.renderSlopeGraphs=function(a,b,c,d,e){var f=this,g=c.slice(1).map(function(a,b){return{left:c[b],left_i:b,right:a,right_i:b+1}}),h=a.selectAll("g.slopegraph").data(g);h.enter().append("g").attr({"class":"slopegraph"}),h.attr({transform:function(a,b){return"translate("+(d[b+1].shift-f.options.slopeWidth)+",0)"}});var i=h.selectAll("line.slope").data(function(a,b){var c={};return a.right.forEach(function(a,b){c[a]=b}),a.left.map(function(a,b){return{data_index:a,lpos:b,rpos:c[a]}}).filter(function(a){return null!=a.rpos})});i.enter().append("line").attr({"class":"slope",x2:this.options.slopeWidth}).on("mouseenter",function(a){f.mouseOver(a.data_index,!0)}).on("mouseleave",function(a){f.mouseOver(a.data_index,!1)}),i.attr({"data-index":function(a){return a.data_index}}),i.attr({y1:function(a){return.5*e.rowHeight(a.lpos)+e.cellY(a.lpos)},y2:function(a){return.5*e.rowHeight(a.rpos)+e.cellY(a.rpos)}}),i.exit().remove(),h.exit().remove()},b.prototype.update=function(){var a=this,b=this.data.getRankings(),c=e.max(b,function(a){return a.getOrder().length})||0,d=this.options.rowHeight*c,f=this.slicer(0,c,function(b){return b*a.options.rowHeight}),h=function(a){return 0===f.from&&a.length<=f.to?a:a.slice(f.from,Math.min(a.length,f.to))},i=b.map(function(a){return h(a.getOrder())}),j=this.createContext(f.from),k=0,l=b.map(function(b,c){var d=k;k+=a.options.slopeWidth;var e=0,f=[b].concat(b.children).map(function(b){var c=e;return e+=b.getWidth()+a.options.columnPadding,b instanceof g.StackColumn&&!b.collapsed&&(e+=a.options.columnPadding*(b.length-1)),c});return k+=e,{shift:d,shifts:f,width:e}});this.$node.attr({width:k,height:d}),this.updateClipPaths(b,j,d);var m=this.$node.select("g.body");m.empty()&&(m=this.$node.append("g").classed("body",!0)),this.renderRankings(m,b,i,l,j),this.renderSlopeGraphs(m,b,i,l,j)},b}(f.AEventDispatcher);c.BodyRenderer=m},{"./model":3,"./renderer":5,"./ui_dialogs":7,"./utils":8,d3:void 0}],7:[function(a,b,c){function d(a,b,c){return void 0===c&&(c=!1),'<span style="font-weight: bold">'+a+'</span><form onsubmit="return false">'+b+'<button type = "submit" class="ok fa fa-check" title="ok"></button><button type = "reset" class="cancel fa fa-times" title="cancel"></button><button type = "button" class="reset fa fa-undo" title="reset"></button></form>'}function e(a,b,c){var e=n.offset(a.node()),f=d3.select("body").append("div").attr({"class":"lu-popup2"}).style({left:e.left+"px",top:e.top+"px"}).html(d(b,c));f.on("keydown",function(){27===d3.event.which&&f.remove()});var g=f.select("input[autofocus]").node();return g&&g.focus(),f}function f(a,b){var c=e(b,"Rename Column",'<input type="text" size="15" value="'+a.label+'" required="required" autofocus="autofocus"><br><input type="color" size="15" value="'+a.color+'" required="required"><br>');c.select(".ok").on("click",function(){var b=c.select('input[type="text"]').property("value"),d=c.select('input[type="color"]').property("value");a.setMetaData(b,d),c.remove()}),c.select(".cancel").on("click",function(){c.remove()})}function g(a,b,c){function d(){var b=f.select('input[type="text"]').property("value"),d=f.select('input[type="text"]').property("checked");d&&(b=new RegExp(b)),c.searchSelect(b,a),f.remove()}var f=e(b,"Search",'<input type="text" size="15" value="" required="required" autofocus="autofocus"><br><label><input type="checkbox">RegExp</label><br>');f.select('input[type="text"]').on("input",function(){var b=d3.event.target.value;if(b.length>=3){var d=f.select('input[type="checkbox"]').property("checked");d&&(b=new RegExp(b)),c.searchSelect(b,a)}}),f.select('input[type="checkbox"]').on("change",d),f.select(".ok").on("click",d),f.select(".cancel").on("click",function(){f.remove()})}function h(a,b){function c(){i.select(".bar").transition().style({width:function(a){return g(a.weight)+"px"}})}var d=a.weights,f=a.children.map(function(a,b){return{col:a,weight:100*d[b]}}),g=d3.scale.linear().domain([0,100]).range([0,120]),h=e(b,"Edit Weights","<table></table>"),i=h.select("table").selectAll("tr").data(f),j=i.enter().append("tr");j.append("td").append("input").attr({type:"number",value:function(a){return a.weight},size:5}).on("input",function(a){a.weight=+this.value,c()}),j.append("td").append("div").attr("class","bar").style("background-color",function(a){return a.col.color}),j.append("td").text(function(a){return a.col.label}),c(),h.select(".cancel").on("click",function(){a.setWeights(d),h.remove()}),h.select(".ok").on("click",function(){a.setWeights(f.map(function(a){return a.weight})),h.remove()})}function i(a,b){function c(){var a=g.select("tbody").selectAll("tr").data(h);a.select(".checkmark").html(function(a){return'<i class="fa fa-'+(a.isChecked?"check-":"")+'square-o"></i>'}).on("click",function(a){a.isChecked=!a.isChecked,c()}),a.select(".datalabel").style("opacity",function(a){return a.isChecked?"1.0":".8"})}function d(c){b.select("i.fa-filter").classed("filtered",c&&c.length>0&&c.length<a.categories.length),a.setFilter(c)}var f=a.getFilter()||[],g=e(b,"Edit Filter",'<div class="selectionTable"><table><thead><th></th><th>Category</th></thead><tbody></tbody></table></div>'),h=a.categories.map(function(a){return{d:a,isChecked:0===f.length||f.indexOf(a)>=0}}),i=g.select("tbody").selectAll("tr").data(h);i.enter().append("tr"),i.append("td").attr("class","checkmark"),i.append("td").attr("class","datalabel").text(function(a){return a.d}),c(),g.select(".cancel").on("click",function(){d(f),g.remove()}),g.select(".reset").on("click",function(){h.forEach(function(a){return a.isChecked=!0}),c(),d(null)}),g.select(".ok").on("click",function(){var b=h.filter(function(a){return a.isChecked}).map(function(a){return a.d});b.length===a.categories.length&&(b=[]),d(b),g.remove()})}function j(a,b){function c(c){b.select("i.fa-filter").classed("filtered",c&&""!==c),a.setFilter(c)}function d(a){var b=g.select('input[type="text"]').property("value");if(b.length>=3||a){var d=g.select('input[type="checkbox"]').property("checked");d&&(b=new RegExp(b)),c(b)}}var f=a.getFilter()||"",g=e(b,"Filter",'<input type="text" placeholder="containing..." autofocus="true" size="15" value="'+(f instanceof RegExp?f.source:f)+'" autofocus="autofocus">\n    <br><label><input type="checkbox" '+(f instanceof RegExp?'checked="checked"':"")+">RegExp</label>\n    <br>");g.select('input[type="checkbox"]').on("change",d),g.select('input[type="text"]').on("input",d),g.select(".cancel").on("click",function(){g.select('input[type="text"]').property("value",f),g.select('input[type="checkbox"]').property("checked",f instanceof RegExp?"checked":null),c(f),g.remove()}),g.select(".reset").on("click",function(){g.select('input[type="text"]').property("value",""),g.select('input[type="checkbox"]').property("checked",null),c(null)}),g.select(".ok").on("click",function(){d(!0),g.remove()})}function k(a,b,c){function e(c){j=c,b.select("i.fa-filter").classed("filtered",!f(j.range(),i.range)||!f(j.domain(),i.domain)),a.setMapping(j.domain(),j.range());var d=l.property("checked");d?a.setFilter(c.domain()[0],c.domain()[1]):a.setFilter()}function f(a,b){return a[0]===b[0]&&a[1]===b[1]}var g=n.offset(b.node()),h=a.getMapping(),i=a.getOriginalMapping(),j=d3.scale.linear().domain(h.domain).range(h.range),k=d3.select("body").append("div").attr({"class":"lu-popup"}).style({left:g.left+"px",top:g.top+"px"}).html(d("Change Mapping",'<div class="mappingArea"></div><label><input type="checkbox" id="filterIt" value="filterIt">Filter Outliers</label><br>')),l=k.select("input").on("change",function(){e(j)});l.property("checked",a.isFiltered());var m={callback:e,triggerCallback:"dragend"},p=c.mappingSample(a),q=o.open(d3.scale.linear().domain(h.domain).range(h.range),i.domain,p,m);k.select(".mappingArea").call(q),k.select(".ok").on("click",function(){e(j),k.remove()}),k.select(".cancel").on("click",function(){a.setMapping(h.domain,h.range),b.classed("filtered",!f(h.range,i.range)||!f(h.domain,i.domain)),k.remove()}),k.select(".reset").on("click",function(){h=i,j=d3.scale.linear().domain(h.domain).range(h.range),e(j),q=o.open(d3.scale.linear().domain(h.domain).range(h.range),i.domain,p,m),k.selectAll(".mappingArea *").remove(),k.select(".mappingArea").call(q)})}function l(a,b){function c(){j.select(".bar").transition().style({width:function(a){return h(a.range)+"px"}})}var d=a.getScale().range,f=a.categoryColors,g=a.categories.map(function(a,b){return{cat:a,range:100*d[b],color:f[b]}}),h=d3.scale.linear().domain([0,100]).range([0,120]),i=e(b,"Edit Categorical Mapping","<table></table>"),j=i.select("table").selectAll("tr").data(g),k=j.enter().append("tr");k.append("td").append("input").attr({type:"number",value:function(a){return a.range},min:0,max:100,size:5}).on("input",function(a){a.range=+this.value,c()}),k.append("td").append("div").attr("class","bar").style("background-color",function(a){return a.color}),k.append("td").text(function(a){return a.cat}),c(),i.select(".cancel").on("click",function(){a.setRange(d),i.remove()}),i.select(".ok").on("click",function(){a.setRange(g.map(function(a){return a.range/100})),i.remove()})}function m(){return{string:j,categorical:i,number:k,ordinal:l}}var n=a("./utils"),o=a("./mappingeditor");c.dialogForm=d,c.makePopup=e,c.openRenameDialog=f,c.openSearchDialog=g,c.openEditWeightsDialog=h,c.filterDialogs=m},{"./mappingeditor":2,"./utils":8}],8:[function(a,b,c){function d(a,b,c){void 0===b&&(b=100),void 0===c&&(c=this);var d=-1;return function(){for(var e=[],f=0;f<arguments.length;f++)e[f-0]=arguments[f];d>=0&&(clearTimeout(d),d=-1),e.unshift(c),d=setTimeout(a.bind.apply(a,e),b)}}function e(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d-0]=arguments[d];c.unshift(b||this.type),a.fire.apply(a,c)}}function f(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];for(var c=null,d=0;d<a.length;d++){var e=a[d],g=Object.keys(e);if(null!==c)for(var h=0;h<g.length;h++){var i=g[h],j=e[i];Object.prototype.toString.call(j)===o?(void 0===c[i]&&(c[i]={}),c[i]=f(c[i],j)):Object.prototype.toString.call(j)===p?(void 0===c[i]&&(c[i]=[]),c[i]=j.concat(c[i])):c[i]=j}else c=e}return c}function g(a){var b=a.getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:b.width,height:b.height}}function h(a,b){var c=a.dataTransfer.types;return"function"==typeof c.indexOf?b.some(function(a){return c.indexOf(a)>=0}):"function"==typeof c.includes?b.some(function(a){return c.includes(a)}):"function"==typeof c.contains?b.some(function(a){return c.contains(a)}):!1}function i(a){var b=a.dataTransfer;return a.ctrlKey&&null!=b.effectAllowed.match(/copy/gi)||null==b.effectAllowed.match(/move/gi)}function j(a){var b=a.dataTransfer;i(a)?b.dropEffect="copy":b.dropEffect="move"}function k(a,b){return function(c){c.on("dragenter",function(){var b=m.event;return h(b,a)?(m.select(this).classed("drag_over",!0),!1):void m.select(this).classed("drag_over",!1)}).on("dragover",function(){var b=m.event;return h(b,a)?(b.preventDefault(),j(b),m.select(this).classed("drag_over",!0),!1):void 0}).on("dragleave",function(){m.select(this).classed("drag_over",!1)}).on("drop",function(c){var d=m.event;if(d.preventDefault(),m.select(this).classed("drag_over",!1),h(d,a)){var e={};return a.forEach(function(a){var b=d.dataTransfer.getData(a);""!==b&&(e[a]=b)}),b(e,c,i(d))}})}}var l=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},m=a("d3");c.delayedCall=d,c.forwardEvent=e;var n=function(){function a(){this.forwarder=e(this),this.listeners=m.dispatch.apply(m,this.createEventList())}return a.prototype.on=function(a,b){var c=this;return arguments.length>1?(Array.isArray(a)?a.forEach(function(a){return c.listeners.on(a,b)}):this.listeners.on(a,b),this):this.listeners.on(a)},a.prototype.createEventList=function(){return[]},a.prototype.fire=function(a){for(var b=this,c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];var e=function(a){var d={source:b,type:a,args:c};b.listeners[a].apply(d,c)};Array.isArray(a)?a.forEach(e.bind(this)):e(a)},a.prototype.forward=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];a.on(b,this.forwarder)},a.prototype.unforward=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];a.on(b,null)},a}();c.AEventDispatcher=n;var o="[object Object]",p="[object Array]";c.merge=f,c.offset=g;var q=function(a){function b(b,c,d){var e=this;void 0===d&&(d={}),a.call(this),this.container=b,this.content=c,this.options={topShift:0,backupRows:5,rowHeight:10},this.prevScrollTop=0,this.shift=0,f(this.options,d),m.select(b).on("scroll.scroller",function(){return e.onScroll()}),this.prevScrollTop=b.scrollTop,this.shift=g(c).top-g(b).top+this.options.topShift}return l(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["scroll","redraw"])},b.prototype.select=function(a,b,c){var d,e=this.container.scrollTop-this.shift,f=e+this.container.clientHeight,g=0;if(e>0){for(g=Math.round(e/this.options.rowHeight);g>=a&&c(g+1)>e;)g--;g-=this.options.backupRows}for(d=Math.round(f/this.options.rowHeight);b>=d&&c(d-1)<f;)d++;return d+=this.options.backupRows,{from:Math.max(g,a),to:Math.min(d,b)}},b.prototype.onScroll=function(){var a=this.container.scrollTop,b=this.container.scrollLeft;this.fire("scroll",a,b),Math.abs(this.prevScrollTop-a)>=this.options.rowHeight*this.options.backupRows&&(this.prevScrollTop=a,this.fire("redraw"))},b.prototype.destroy=function(){m.select(this.container).on("scroll.scroller",null)},b}(n);c.ContentScroller=q,c.hasDnDType=h,c.copyDnD=i,c.updateDropEffect=j,c.dropAble=k},{d3:void 0}]},{},[1]);